#Acorns of code: The role of bioinformatics in determining the consequences of climate change for cork oak populations.

##What if bioinformatics could help us understand</br>how cork oak tackles climate change?

###Francisco Pina-Martins ([@FPinaMartins](https://twitter.com/FPinaMartins))
####Octávio S. Paulo
#####[https://stuntspt.github.io/BODs2017/](https://stuntspt.github.io/BODs2017/)

<img src="assets/Cover_slide.png" />


.fx: titleslide transparentheading coverslide

---

#The cork oak

* "Analyses of the genomic variation to study cork oak evolution and adaptation: from past to future climatic changes."

![sobreiro](assets/sobreiro.jpg)

.fx: alt_background

---

#The cork oak

* "Analyses of the genomic variation to study cork oak evolution and adaptation: from past to future climatic changes."

![sobreiro](assets/sobreiro.jpg)

* "Programa Doutoral em Biologia e Ecologia das Alterações Globais"

.fx: alt_background

---

#The cork oak

* "Analyses of the genomic variation to study cork oak evolution and adaptation: from past to future climatic changes."

![sobreiro](assets/sobreiro.jpg)

* "Programa Doutoral em Biologia e Ecologia das Alterações Globais"
* Evolutionary biology of *Quercus suber*

.fx: alt_background

---

#The cork oak

* Very broad distribution

.fx: alt_background

---

![hot](assets/hot_summer.jpg)

.fx: imageslide

---

![dist-map](assets/cold_winter.jpg)

.fx: imageslide

---

#The cork oak

* Very broad distribution

![dist-map](assets/dist_map.png)

.fx: alt_background

---

#The cork oak

* Very broad distribution

![dist-map](assets/dist_map_samples.png)

.fx: alt_background

---

#The cork oak

* Plenty of previous studies

.fx: alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological

.fx: alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological

![eco-paper](assets/paper_eco.gif)

.fx: compimageslide alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological

.fx: alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological


![physio-paper](assets/paper_physio.png)

.fx: compimageslide alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological
    * Dispersal

.fx: alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological
    * Dispersal

![dispersal-paper](assets/paper_disp.png)

.fx: compimageslide alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological
    * Dispersal
    * Genetic

.fx: alt_background alt_background

---

#The cork oak

* Plenty of previous studies
    * Ecological
    * Physiological
    * Dispersal
    * Genetic

![genetics-papers](assets/papers_genetics.png)

.fx: compimageslide alt_background

---

#The cork oak

* Hardly any genomic resources

.fx: alt_background

---

#The cork oak

* Hardly any genomic resources
    * No reference genome

.fx: alt_background

---

#The cork oak

* Hardly any genomic resources
    * No reference genome
    * Few GenBank resources (591 "cds" records)

.fx: alt_background

---

#The cork oak

* Hardly any genomic resources
    * No reference genome
    * Few GenBank resources (591 "cds" records)
        * 460 of which are from a paper from our group

.fx: alt_background

---

#The cork oak

* Hardly any genomic resources
    * No reference genome
    * Few GenBank resources (591 "cds" records)
        * 460 of which are from a paper from our group
    * Very few annotations

.fx: alt_background

---

#The strategy

* 454

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom
    * Pop. genetics/Evo. history

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom
    * Pop. genetics/Evo. history
* GBS

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom
    * Pop. genetics/Evo. history
* GBS
    * **G**enome **W**ide **A**ssociation **S**tudy (**GWAS**)

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom
    * Pop. genetics/Evo. history
* GBS
    * **G**enome **W**ide **A**ssociation **S**tudy (**GWAS**)

![blue-red-pill](assets/red_pill_blue_pill.jpg)

.fx: alt_background muchsmaller

---

#The strategy

* 454
    * Exploration
* Sequenom
    * Pop. genetics/Evo. history
* GBS
    * **G**enome **W**ide **A**ssociation **S**tudy (**GWAS**)

![blue-red-pill](assets/red_pill_blue_pill.jpg)


<center>**[Take the red pill]**</center>

.fx: muchsmaller

---

#454 data

* No strain information

---

#454 data

* No strain information
* No reference genome

---

#454 data

* No strain information
* No reference genome
* How do we call SNPs?

---

#454 data

* No strain information
* No reference genome
* How do we call SNPs?

![454](assets/454.jpg)

---

#454 data

* Manual methods
* *Custom scripts*
* Develop our own method
* Meet *[4Pipe4](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-016-0892-1)*

<a href="https://github.com/StuntsPT/4Pipe4"><img src="assets/github_green.png" class="forkme" /></a>

.fx: github 

---

![4Pipe4](assets/4pipe4.png)

.fx: imageslide

---

![4Pipe4](assets/4pipe4_2.png)

.fx: imageslide

---

#*4Pipe4*

* Started in 2010
* Written in *python 3*
    * Functional programming
    * Split in modules
    * Small use of classes
* Outperforms every other tested method on **P**ositive **P**redictive **V**alue (**PPV**)
* Published in 2016

<a href="https://github.com/StuntsPT/4Pipe4"><img src="assets/github_green.png" class="forkme" /></a>

.fx: github 

---

#454 data

* Resulted in 402 called SNPs
    * All SNPs were called inside ORFs
    * All had a BLAST match to *something*

* Validation
* Referencing

---

#Sequenom data

* Based on the previous 454 dataset
* 36 SNPs expanded to 275 individuals

![Sequenom pic](assets/sequenom.png)

---

#Sequenom data analyses

* Fixed dataset
* Performed plenty of test runs
* Great as 'hands on' approach to SNP data analyses
* **Mostly** manual

---

#Structure_threader

* Automates & paralelizes STRUCTURE & fastStructure analyses
* Saved a reasonale ammount of analyses time
* Less human intervention == less random error

<a href="https://github.com/StuntsPT/Structure_threader"><img src="assets/github_green.png" class="forkme" /></a>

![smith clones](assets/smithclones.jpg)

.fx: github

---


Objetivos de cada um
Pontos a focar:
* 4Pipe4
* Geração do sequenom
* análise do sequenom
    * repetição
* automatismos?
* Análise do GBS
    * versões de programas
    * repetições
    * automatismos
    * interpretação
    * RONA

---

#The cork oak

![cork oak](assets/sobreiro2.jpg)


---

#The cork oak

![cork oak](assets/sobreiro2_matrix.jpg)

---

